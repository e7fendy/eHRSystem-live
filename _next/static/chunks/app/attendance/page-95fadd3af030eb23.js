(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[344],{5601:(e,t,s)=>{Promise.resolve().then(s.bind(s,5310))},6889:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(7401).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},5236:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(7401).A)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]])},2823:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(7401).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},5310:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>w});var a=s(5155),r=s(2115),l=s(6046),n=s(8435),d=s(183),c=s(7492),o=s(5121),i=s(4505),m=s(7401);let x=(0,m.A)("log-in",[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]]);var u=s(5236),p=s(6889);let f=e=>{let{data:t,isLoading:s}=e,{t:r}=(0,d.o)(),l=e=>{switch(e){case"present":return"bg-green-500 hover:bg-green-600 text-white";case"incomplete":return"bg-red-500 hover:bg-red-600 text-white";case"absent":return"bg-slate-300 hover:bg-slate-400 text-slate-700";case"off":return"bg-slate-100 hover:bg-slate-200 text-slate-400";default:return"bg-slate-50 text-slate-300"}},n=e=>e?new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0}):"--:--";if(s)return(0,a.jsx)("div",{className:"flex h-[400px] items-center justify-center",children:(0,a.jsx)(i.A,{className:"h-8 w-8 animate-spin text-primary"})});let c=Array.from({length:t.length>0?new Date(t[0].date).getDay():0},(e,t)=>t);return(0,a.jsxs)("div",{className:"w-full flex flex-col items-center space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-7 gap-1 sm:gap-1.5 w-full max-w-sm",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,a.jsx)("div",{className:"text-center text-[10px] sm:text-xs font-bold text-muted-foreground uppercase tracking-wider pb-2",children:e},e)),c.map(e=>(0,a.jsx)("div",{className:"aspect-square"},"empty-".concat(e))),t.map(e=>{let t=new Date(e.date),s=t.getDate();return(0,a.jsxs)("div",{className:"relative group aspect-square",children:[(0,a.jsx)("div",{className:"w-full h-full rounded-md sm:rounded-lg flex items-center justify-center text-[10px] sm:text-xs font-bold transition-all cursor-default ".concat(l(e.status)," shadow-sm"),children:s}),(0,a.jsxs)("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-48 p-3 bg-popover text-popover-foreground rounded-xl shadow-xl border z-50 opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity",children:[(0,a.jsx)("p",{className:"font-bold text-sm mb-2 border-b pb-1",children:t.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}),(0,a.jsxs)("div",{className:"space-y-1.5 text-xs",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1.5 text-muted-foreground",children:[(0,a.jsx)(x,{className:"h-3 w-3"})," ",r("attendance.clockIn")]}),(0,a.jsx)("span",{className:"font-medium",children:n(e.inTime)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1.5 text-muted-foreground",children:[(0,a.jsx)(u.A,{className:"h-3 w-3"})," ",r("attendance.clockOut")]}),(0,a.jsx)("span",{className:"font-medium",children:n(e.outTime)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-1 border-t",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1.5 text-muted-foreground font-bold",children:[(0,a.jsx)(p.A,{className:"h-3 w-3"})," ",r("attendance.duration")]}),(0,a.jsxs)("span",{className:"font-bold text-primary",children:[e.durationHours,"h"]})]}),(0,a.jsx)("div",{className:"pt-1",children:(0,a.jsx)(o.E,{variant:"outline",className:"w-full justify-center text-[10px] uppercase py-0 h-4",children:r("attendance.".concat(e.status))})})]}),(0,a.jsx)("div",{className:"absolute top-full left-1/2 -translate-x-1/2 border-8 border-transparent border-t-popover"})]})]},e.date)})]}),(0,a.jsxs)("div",{className:"flex flex-wrap justify-center gap-x-4 gap-y-2 pt-6 w-full max-w-sm border-t",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-green-500 shadow-sm"}),(0,a.jsx)("span",{className:"text-muted-foreground font-medium text-[11px] sm:text-xs",children:r("attendance.present")})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-red-500 shadow-sm"}),(0,a.jsx)("span",{className:"text-muted-foreground font-medium text-[11px] sm:text-xs",children:r("attendance.incomplete")})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-slate-300 shadow-sm"}),(0,a.jsx)("span",{className:"text-muted-foreground font-medium text-[11px] sm:text-xs",children:r("attendance.absent")})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-slate-100 shadow-sm border border-slate-200"}),(0,a.jsx)("span",{className:"text-muted-foreground font-medium text-[11px] sm:text-xs",children:r("attendance.off")})]})]})]})};var h=s(9749),g=s(7528),y=s(2823);let j=(0,m.A)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),b=(0,m.A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),v=(0,m.A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var N=s(814);function w(){let{user:e,isLoading:t}=(0,n.A)(),{t:s}=(0,d.o)(),o=(0,l.useRouter)(),m=(0,l.useSearchParams)(),x=(0,l.usePathname)(),u=new Date,w=m.get("year")?parseInt(m.get("year")):u.getFullYear(),k=m.get("month")?parseInt(m.get("month")):u.getMonth()+1,A=m.get("userId")||"",[C,S]=(0,r.useState)(k),[D,I]=(0,r.useState)(w),[L,M]=(0,r.useState)(A),[R,q]=(0,r.useState)([]),[E,P]=(0,r.useState)([]),[U,z]=(0,r.useState)(null),[H,T]=(0,r.useState)(!0),[F,V]=(0,r.useState)(!1),_=(null==e?void 0:e.role.toUpperCase())==="ADMIN";(0,r.useEffect)(()=>{let s=async()=>{if(_){V(!0);try{let t=await c.K.getUsers(1,100);t.success&&(q(t.users),!L&&e&&M(e.userId))}catch(e){console.error("Failed to fetch users:",e)}finally{V(!1)}}};!t&&e&&s()},[_,t,e,L]),(0,r.useEffect)(()=>{t||!e||_||M(e.userId)},[t,e,_]),(0,r.useEffect)(()=>{if(!t&&e){let e=new URLSearchParams(m.toString());e.set("year",D.toString()),e.set("month",C.toString()),L&&e.set("userId",L);let t=e.toString();t!==m.toString()&&o.replace("".concat(x,"?").concat(t),{scroll:!1})}},[D,C,L,t,e,x,o,m]),(0,r.useEffect)(()=>{t||e||o.push("/login")},[e,t,o]);let W=Array.from({length:12},(e,t)=>({value:t+1,label:new Date(0,t).toLocaleString(void 0,{month:"long"})})),Y=Array.from({length:5},(e,t)=>u.getFullYear()-t),Z=(0,r.useCallback)(async()=>{if(L){T(!0);try{let e=await c.K.getUserAttendance(L,C,D);e.success?(P(e.data),z(e.summary)):N.oR.error(e.message||s("common.error"))}catch(e){N.oR.error(s("dashboard.serverError"))}finally{T(!1)}}},[L,C,D,s]);(0,r.useEffect)(()=>{!t&&L&&Z()},[t,L,Z]);let J=e=>{let{title:t,value:s,unit:r="",icon:l,iconColor:n,bgColor:d,textColor:c,isLoading:o}=e;return(0,a.jsx)(h.Zp,{className:"rounded-3xl shadow-sm border-none bg-background overflow-hidden",children:(0,a.jsxs)(h.Wu,{className:"p-5 sm:p-6 flex flex-col gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-2xl ".concat(d," flex items-center justify-center ").concat(n),children:(0,a.jsx)(l,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs sm:text-sm font-bold text-muted-foreground uppercase tracking-wider",children:t}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("p",{className:"text-xl sm:text-2xl font-black mt-1 ".concat(c," ").concat(o?"animate-pulse opacity-50":""),children:[o?"--":s,r]}),o&&(0,a.jsx)(i.A,{className:"h-4 w-4 animate-spin text-muted-foreground mt-1"})]})]})]})})};return t||!e?(0,a.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,a.jsx)(i.A,{className:"h-8 w-8 animate-spin text-primary"})}):(0,a.jsxs)("div",{className:"p-4 sm:p-8 max-w-7xl mx-auto space-y-6 sm:space-y-8 min-h-screen bg-muted/30",children:[(0,a.jsxs)(h.Zp,{className:"shadow-none border-none bg-background rounded-3xl",children:[(0,a.jsx)(h.aR,{className:"p-6 sm:p-8",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-6",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(h.ZB,{className:"hidden sm:block text-2xl sm:text-3xl font-bold tracking-tight",children:s("attendance.title")}),(0,a.jsxs)(h.BT,{className:"text-sm sm:text-base",children:[s("admin.selectPeriod")," â€¢ ",s("admin.calculationInfo")]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-3",children:[_&&(0,a.jsxs)(g.l6,{value:L,onValueChange:M,disabled:F,children:[(0,a.jsx)(g.bq,{className:"w-full sm:w-[200px] h-11 rounded-xl border-muted-foreground/20",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)(g.yv,{placeholder:s("admin.selectUser")})]})}),(0,a.jsx)(g.gC,{children:R.map(e=>(0,a.jsxs)(g.eb,{value:e.userId,children:[e.name," (@",e.username,")"]},e.userId))})]}),(0,a.jsxs)(g.l6,{value:D.toString(),onValueChange:e=>I(parseInt(e)),children:[(0,a.jsx)(g.bq,{className:"w-[100px] sm:w-[120px] h-11 rounded-xl border-muted-foreground/20",children:(0,a.jsx)(g.yv,{placeholder:s("attendance.selectYear")})}),(0,a.jsx)(g.gC,{children:Y.map(e=>(0,a.jsx)(g.eb,{value:e.toString(),children:e},e))})]}),(0,a.jsxs)(g.l6,{value:C.toString(),onValueChange:e=>S(parseInt(e)),children:[(0,a.jsx)(g.bq,{className:"w-[120px] sm:w-[150px] h-11 rounded-xl border-muted-foreground/20",children:(0,a.jsx)(g.yv,{placeholder:s("attendance.selectMonth")})}),(0,a.jsx)(g.gC,{children:W.map(e=>(0,a.jsx)(g.eb,{value:e.value.toString(),children:e.label},e.value))})]})]})]})}),(0,a.jsx)(h.Wu,{className:"p-6 sm:p-8 pt-0",children:(0,a.jsx)(f,{data:E,isLoading:H})})]}),(U||H)&&(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 sm:gap-6",children:[(0,a.jsx)(J,{title:s("attendance.totalHours"),value:null==U?void 0:U.totalHours,unit:"h",icon:p.A,iconColor:"text-primary",bgColor:"bg-primary/10",isLoading:H}),(0,a.jsx)(J,{title:s("attendance.presentDays"),value:null==U?void 0:U.presentDays,icon:j,iconColor:"text-green-600",bgColor:"bg-green-500/10",textColor:"text-green-600",isLoading:H}),(0,a.jsx)(J,{title:s("attendance.incompleteDays"),value:null==U?void 0:U.incompleteDays,icon:b,iconColor:"text-red-600",bgColor:"bg-red-500/10",textColor:"text-red-600",isLoading:H}),(0,a.jsx)(J,{title:s("attendance.absentDays"),value:null==U?void 0:U.absentDays,icon:v,iconColor:"text-slate-600",bgColor:"bg-slate-500/10",textColor:"text-slate-600",isLoading:H})]})]})}},5121:(e,t,s)=>{"use strict";s.d(t,{E:()=>d});var a=s(5155);s(2115);var r=s(1027),l=s(1567);let n=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,l.cn)(n({variant:s}),t),...r})}},7528:(e,t,s)=>{"use strict";s.d(t,{bq:()=>x,eb:()=>h,gC:()=>f,l6:()=>i,yv:()=>m});var a=s(5155),r=s(2115),l=s(51),n=s(1719),d=s(1902),c=s(8867),o=s(1567);let i=l.bL;l.YJ;let m=l.WT,x=r.forwardRef((e,t)=>{let{className:s,children:r,...d}=e;return(0,a.jsxs)(l.l9,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...d,children:[r,(0,a.jsx)(l.In,{asChild:!0,children:(0,a.jsx)(n.A,{className:"h-4 w-4 opacity-50"})})]})});x.displayName=l.l9.displayName;let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.PP,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})});u.displayName=l.PP.displayName;let p=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.wn,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(n.A,{className:"h-4 w-4"})})});p.displayName=l.wn.displayName;let f=r.forwardRef((e,t)=>{let{className:s,children:r,position:n="popper",...d}=e;return(0,a.jsx)(l.ZL,{children:(0,a.jsxs)(l.UC,{ref:t,className:(0,o.cn)("relative z-[110] max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n,...d,children:[(0,a.jsx)(u,{}),(0,a.jsx)(l.LM,{className:(0,o.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(p,{})]})})});f.displayName=l.UC.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.JU,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...r})}).displayName=l.JU.displayName;let h=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsxs)(l.q7,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(l.VF,{children:(0,a.jsx)(c.A,{className:"h-4 w-4"})})}),(0,a.jsx)(l.p4,{children:r})]})});h.displayName=l.q7.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.wv,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",s),...r})}).displayName=l.wv.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[65,814,991,928,397,441,517,358],()=>t(5601)),_N_E=e.O()}]);