(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{943:(e,s,t)=>{Promise.resolve().then(t.bind(t,2303))},2303:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>f});var r=t(5155),a=t(2115),o=t(6046),n=t(8435),l=t(183),i=t(7492),c=t(9778),d=t(7302),u=t(5044),m=t(8233),p=t(814);function f(){let{user:e,isLoading:s,login:t}=(0,n.A)(),{t:f}=(0,l.o)(),g=(0,o.useRouter)(),h="true"===(0,o.useSearchParams)().get("reset"),[x,v]=(0,a.useState)(""),[b,w]=(0,a.useState)(""),[y,S]=(0,a.useState)(""),[P,N]=(0,a.useState)(!1);(0,a.useEffect)(()=>{s||(e?v(e.name):g.push("/login"))},[e,s,g]),(0,a.useEffect)(()=>{h&&setTimeout(()=>p.oR.warning(f("profile.defaultPasswordWarning")),500)},[h,f]);let C=async s=>{if(s.preventDefault(),b&&b!==y){p.oR.error(f("profile.passwordMismatch"));return}N(!0);try{let s=await i.K.updateProfile(e.username,x,b||void 0);s.success?(p.oR.success(f("profile.success")),t({...e,name:x}),h?g.push("/"):(w(""),S(""))):p.oR.error(s.message||f("profile.updateError"))}catch(e){p.oR.error(f("common.error"))}finally{N(!1)}};return s||!e?null:(0,r.jsx)("div",{className:"min-h-[calc(100vh-72px)] md:min-h-screen p-6 md:p-12 bg-[#f8fafe] flex items-center justify-center font-sans",children:(0,r.jsxs)(c.Z,{className:"w-full max-w-md p-4 shadow-none sm:shadow-[0_20px_60px_-15px_rgba(0,0,0,0.1)] border-none overflow-hidden rounded-[40px] bg-white",children:[(0,r.jsx)(d.d,{className:"flex gap-3 px-6 pt-8 pb-4",children:(0,r.jsx)("div",{className:"flex flex-col",children:(0,r.jsx)("p",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:f("profile.title")})})}),(0,r.jsxs)(u.U,{className:"px-6 pb-8",children:[h&&(0,r.jsxs)("div",{className:"bg-yellow-50 text-yellow-800 p-3 rounded-xl mb-6 text-sm font-medium border border-yellow-100 flex items-center gap-2",children:[(0,r.jsx)("span",{children:"⚠️"}),f("profile.defaultPasswordWarning")]}),(0,r.jsxs)("form",{onSubmit:C,className:"flex flex-col gap-8 sm:gap-6",children:[(0,r.jsxs)("div",{className:"space-y-3 sm:space-y-2",children:[(0,r.jsx)("label",{className:"text-sm sm:text-sm font-semibold text-slate-700 ml-1",htmlFor:"name",children:f("profile.name")}),(0,r.jsx)("input",{id:"name",placeholder:f("profile.name"),value:x,onChange:e=>v(e.target.value),required:!0,className:"w-full px-6 h-[56px] sm:h-[52px] bg-[#f8faff] border border-slate-100 rounded-[20px] text-lg sm:text-base text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all duration-200"})]}),(0,r.jsxs)("div",{className:"space-y-8 sm:space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-3 sm:space-y-2",children:[(0,r.jsx)("label",{className:"text-sm sm:text-sm font-semibold text-slate-700 ml-1",htmlFor:"newPassword",children:f("profile.newPassword")}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("input",{id:"newPassword",placeholder:f("profile.newPassword"),type:"password",value:b,onChange:e=>w(e.target.value),className:"w-full px-6 h-[56px] sm:h-[52px] bg-[#f8faff] border border-slate-100 rounded-[20px] text-lg sm:text-base text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all duration-200"}),(0,r.jsx)("p",{className:"text-xs text-slate-400 px-1",children:f("profile.leaveBlank")})]})]}),(0,r.jsxs)("div",{className:"space-y-3 sm:space-y-2",children:[(0,r.jsx)("label",{className:"text-sm sm:text-sm font-semibold text-slate-700 ml-1",htmlFor:"confirmPassword",children:f("profile.confirmPassword")}),(0,r.jsx)("input",{id:"confirmPassword",placeholder:f("profile.confirmPassword"),type:"password",value:y,onChange:e=>S(e.target.value),className:"w-full px-6 h-[56px] sm:h-[52px] bg-[#f8faff] border border-slate-100 rounded-[20px] text-lg sm:text-base text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all duration-200"})]})]}),(0,r.jsx)(m.T,{type:"submit",isLoading:P,className:"w-full h-[64px] sm:h-[56px] bg-[#5356FF] hover:bg-[#4346FF] text-white font-bold rounded-[24px] shadow-xl shadow-blue-200/50 transition-all active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-3 mt-4 sm:mt-2 text-xl sm:text-lg",children:P?f("profile.saving"):f("profile.save")})]})]})]})})}},8435:(e,s,t)=>{"use strict";t.d(s,{A:()=>l,AuthProvider:()=>n});var r=t(5155),a=t(2115);let o=(0,a.createContext)(void 0),n=e=>{let{children:s}=e,[t,n]=(0,a.useState)(null),[l,i]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=localStorage.getItem("ehr_user");if(e)try{n(JSON.parse(e))}catch(e){localStorage.removeItem("ehr_user")}i(!1)},[]),(0,r.jsx)(o.Provider,{value:{user:t,login:e=>{n(e),localStorage.setItem("ehr_user",JSON.stringify(e))},logout:()=>{n(null),localStorage.removeItem("ehr_user")},isLoading:l},children:s})},l=()=>{let e=(0,a.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},183:(e,s,t)=>{"use strict";t.d(s,{I:()=>l,o:()=>i});var r=t(5155),a=t(2115);let o={en:{common:{appName:"eHR System",signOut:"Sign Out",loading:"Loading...",error:"Error",success:"Success",notice:"Notice",systemInfo:"System Info"},login:{welcomeBack:"Welcome Back",signInToAccount:"Sign in to your eHR account",username:"Username",password:"Password",signIn:"Sign In",signingIn:"Signing in...",invalidCredentials:"Invalid credentials",connectionError:"Failed to connect to the server. Please check your connection and GAS URL.",needHelp:"Need help?",contactSupport:"Contact Support",managementSystem:"Management System",enterUsername:"Enter your username",enterPassword:"Enter your password"},dashboard:{welcome:"Welcome, {name}",role:"Role: {role}",attendanceAction:"Attendance Action",capturedWithGps:"Captured with GPS location",clockIn:"CLOCK IN",clockOut:"CLOCK OUT",capturingLocation:"Capturing location...",recordingClockIn:"Recording Clock In...",recordingClockOut:"Recording Clock Out...",clockedInSuccess:"Clocked in successfully!",clockedOutSuccess:"Clocked out successfully!",failedToRecord:"Failed to record attendance",serverError:"Server connection error. Check GAS URL.",locationError:"Location error: {error}. Please enable GPS.",geoNotSupported:"Geolocation is not supported by your browser",deviceDetected:"Device Detected",gpsStatus:"GPS Status",active:"Active",awaitingPermission:"Awaiting Permission",noticeContent:"Please ensure you are at the work location before clocking in. Your GPS coordinates are recorded for verification.",allRightsReserved:"All rights reserved."},profile:{title:"Edit Profile",name:"Name",newPassword:"New Password",confirmPassword:"Confirm New Password",save:"Save Changes",saving:"Saving...",success:"Profile updated successfully",passwordMismatch:"Passwords do not match",updateError:"Failed to update profile",defaultPasswordWarning:"Please change your default password to continue.",leaveBlank:"Leave blank to keep current password"}},"zh-tw":{common:{appName:"人事管理系統",signOut:"登出",loading:"載入中...",error:"錯誤",success:"成功",notice:"注意事項",systemInfo:"系統資訊"},login:{welcomeBack:"歡迎回來",signInToAccount:"請登入您的人事系統帳號",username:"使用者名稱",password:"密碼",signIn:"登入",signingIn:"登入中...",invalidCredentials:"帳號或密碼錯誤",connectionError:"連線伺服器失敗。請檢查您的網路連線與 GAS 網址。",needHelp:"需要幫助？",contactSupport:"聯繫支援",managementSystem:"管理系統",enterUsername:"請輸入使用者名稱",enterPassword:"請輸入密碼"},dashboard:{welcome:"歡迎，{name}",role:"角色：{role}",attendanceAction:"出勤操作",capturedWithGps:"將記錄 GPS 座標",clockIn:"上班打卡",clockOut:"下班打卡",capturingLocation:"正在取得位置...",recordingClockIn:"正在記錄上班時間...",recordingClockOut:"正在記錄下班時間...",clockedInSuccess:"上班打卡成功！",clockedOutSuccess:"下班打卡成功！",failedToRecord:"記錄出勤失敗",serverError:"伺服器連線錯誤。請檢查 GAS 網址。",locationError:"位置錯誤：{error}。請開啟 GPS。",geoNotSupported:"您的瀏覽器不支援地理位置功能",deviceDetected:"偵測裝置",gpsStatus:"GPS 狀態",active:"已啟用",awaitingPermission:"等待權限",noticeContent:"打卡前請確保您已到達工作地點。系統將會記錄您的 GPS 座標以便查核。",allRightsReserved:"版權所有。"},profile:{title:"編輯個人資料",name:"姓名",newPassword:"新密碼",confirmPassword:"確認新密碼",save:"儲存變更",saving:"儲存中...",success:"個人資料更新成功",passwordMismatch:"密碼不相符",updateError:"更新個人資料失敗",defaultPasswordWarning:"請更改預設密碼以繼續使用。",leaveBlank:"若不修改密碼請留空"}}},n=(0,a.createContext)(void 0),l=e=>{let{children:s}=e,[t,l]=(0,a.useState)("en");return(0,a.useEffect)(()=>{let e=localStorage.getItem("language");e&&("en"===e||"zh-tw"===e)?l(e):navigator.language.toLowerCase().startsWith("zh")&&l("zh-tw")},[]),(0,r.jsx)(n.Provider,{value:{language:t,setLanguage:e=>{l(e),localStorage.setItem("language",e)},t:(e,s)=>{let r=e.split("."),a=o[t];for(let s of r){if(void 0===a[s])return e;a=a[s]}return"string"==typeof a&&s&&Object.entries(s).forEach(e=>{let[s,t]=e;a=a.replace("{".concat(s,"}"),t)}),a}},children:s})},i=()=>{let e=(0,a.useContext)(n);if(void 0===e)throw Error("useLanguage must be used within a LanguageProvider");return e}},7492:(e,s,t)=>{"use strict";async function r(e){let s=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",s))).map(e=>e.toString(16).padStart(2,"0")).join("")}t.d(s,{K:()=>o});let a="https://script.google.com/macros/s/AKfycbzmxEOsly16LJr9Cc_lxRq9owKjDq2j1Z7BjhzxIP3BggbNEhoZmjqJldx4MJn65_ZU/exec",o={async login(e,s){let t=await r(s);return(await fetch(a,{method:"POST",mode:"cors",body:JSON.stringify({action:"login",username:e,password:t})})).json()},async updateProfile(e,s,t){let o={action:"updateUser",username:e,name:s};return t&&(o.password=await r(t)),(await fetch(a,{method:"POST",mode:"cors",body:JSON.stringify(o)})).json()},recordAttendance:async e=>(await fetch(a,{method:"POST",mode:"cors",body:JSON.stringify({action:"attendance",...e})})).json()}},7302:(e,s,t)=>{"use strict";t.d(s,{d:()=>c});var r=t(9644),a=t(8117),o=t(7568),n=t(4675),l=t(5155),i=(0,a.Rf)((e,s)=>{var t;let{as:a,className:i,children:c,...d}=e,u=(0,o.zD)(s),{slots:m,classNames:p}=(0,r.f)(),f=(0,n.cn)(null==p?void 0:p.header,i);return(0,l.jsx)(a||"div",{ref:u,className:null==(t=m.header)?void 0:t.call(m,{class:f}),...d,children:c})});i.displayName="HeroUI.CardHeader";var c=i},9778:(e,s,t)=>{"use strict";t.d(s,{Z:()=>b});var r=t(9644),a=t(5369),o=t(4675),n=t(2115),l=t(7010),i=t(3201),c=t(8553),d=t(7298),u=t(8117),m=t(9353),p=t(624),f=t(7568),g=t(8259),h=t(443),x=t(5155),v=(0,u.Rf)((e,s)=>{let{children:t,context:v,Component:b,isPressable:w,disableAnimation:y,disableRipple:S,getCardProps:P,getRippleProps:N}=function(e){var s,t,r,h;let x=(0,d.o)(),[v,b]=(0,u.rE)(e,a.Nr.variantKeys),{ref:w,as:y,children:S,onClick:P,onPress:N,autoFocus:C,className:j,classNames:k,allowTextSelectionOnPress:E=!0,...I}=v,A=(0,f.zD)(w),O=y||(e.isPressable?"button":"div"),R="string"==typeof O,D=null!=(t=null!=(s=e.disableAnimation)?s:null==x?void 0:x.disableAnimation)&&t,_=null!=(h=null!=(r=e.disableRipple)?r:null==x?void 0:x.disableRipple)&&h,G=(0,o.cn)(null==k?void 0:k.base,j),{onClear:L,onPress:H,ripples:U}=(0,g.k)(),F=(0,n.useCallback)(e=>{_||D||!A.current||H(e)},[_,D,A,H]),{buttonProps:B,isPressed:T}=(0,c.l)({onPress:(0,m.cy)(N,F),elementType:y,isDisabled:!e.isPressable,onClick:P,allowTextSelectionOnPress:E,...I},A),{hoverProps:W,isHovered:z}=(0,i.M)({isDisabled:!e.isHoverable,...I}),{isFocusVisible:M,isFocused:J,focusProps:K}=(0,l.o)({autoFocus:C}),q=(0,n.useMemo)(()=>(0,a.Nr)({...b,disableAnimation:D}),[(0,m.t6)(b),D]),Z=(0,n.useMemo)(()=>({slots:q,classNames:k,disableAnimation:D,isDisabled:e.isDisabled,isFooterBlurred:e.isFooterBlurred,fullWidth:e.fullWidth}),[q,k,e.isDisabled,e.isFooterBlurred,D,e.fullWidth]),$=(0,n.useCallback)(function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ref:A,className:q.base({class:G}),tabIndex:e.isPressable?0:-1,"data-hover":(0,m.sE)(z),"data-pressed":(0,m.sE)(T),"data-focus":(0,m.sE)(J),"data-focus-visible":(0,m.sE)(M),"data-disabled":(0,m.sE)(e.isDisabled),...(0,m.v6)(e.isPressable?{...B,...K,role:"button"}:{},e.isHoverable?W:{},(0,p.$)(I,{enabled:R}),(0,p.$)(s))}},[A,q,G,R,e.isPressable,e.isHoverable,e.isDisabled,z,T,M,B,K,W,I]),Y=(0,n.useCallback)(()=>({ripples:U,onClear:L}),[U,L]);return{context:Z,domRef:A,Component:O,classNames:k,children:S,isHovered:z,isPressed:T,disableAnimation:D,isPressable:e.isPressable,isHoverable:e.isHoverable,disableRipple:_,handlePress:F,isFocusVisible:M,getCardProps:$,getRippleProps:Y}}({...e,ref:s});return(0,x.jsxs)(b,{...P(),children:[(0,x.jsx)(r.u,{value:v,children:t}),w&&!y&&!S&&(0,x.jsx)(h.j,{...N()})]})});v.displayName="HeroUI.Card";var b=v},5044:(e,s,t)=>{"use strict";t.d(s,{U:()=>c});var r=t(9644),a=t(8117),o=t(7568),n=t(4675),l=t(5155),i=(0,a.Rf)((e,s)=>{var t;let{as:a,className:i,children:c,...d}=e,u=(0,o.zD)(s),{slots:m,classNames:p}=(0,r.f)(),f=(0,n.cn)(null==p?void 0:p.body,i);return(0,l.jsx)(a||"div",{ref:u,className:null==(t=m.body)?void 0:t.call(m,{class:f}),...d,children:c})});i.displayName="HeroUI.CardBody";var c=i},9644:(e,s,t)=>{"use strict";t.d(s,{f:()=>a,u:()=>r});var[r,a]=(0,t(121).q)({name:"CardContext",strict:!0,errorMessage:"useCardContext: `context` is undefined. Seems you forgot to wrap component within <Card />"})}},e=>{var s=s=>e(e.s=s);e.O(0,[662,125,814,441,517,358],()=>s(943)),_N_E=e.O()}]);