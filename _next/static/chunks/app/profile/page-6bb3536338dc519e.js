(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{943:(e,t,r)=>{Promise.resolve().then(r.bind(r,975))},4505:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(7401).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},975:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var s=r(5155),a=r(2115),o=r(6046),n=r(8435),i=r(183),d=r(7492),c=r(3312),l=r(9749),u=r(3900),m=r(8986),f=r(814);let p=(0,r(7401).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var g=r(4505);function h(){let{user:e,isLoading:t,login:r}=(0,n.A)(),{t:h}=(0,i.o)(),w=(0,o.useRouter)(),v="true"===(0,o.useSearchParams)().get("reset"),[y,x]=(0,a.useState)(""),[S,b]=(0,a.useState)(""),[N,P]=(0,a.useState)(""),[j,k]=(0,a.useState)(!1);(0,a.useEffect)(()=>{t||(e?x(e.name):w.push("/login"))},[e,t,w]),(0,a.useEffect)(()=>{v&&setTimeout(()=>f.oR.warning(h("profile.defaultPasswordWarning")),500)},[v,h]);let C=async t=>{if(t.preventDefault(),S&&S!==N){f.oR.error(h("profile.passwordMismatch"));return}k(!0);try{let t=await d.K.updateProfile(e.userId,y,S||void 0);t.success?(f.oR.success(h("profile.success")),r({...e,name:y}),v?w.push("/"):(b(""),P(""))):f.oR.error(t.message||h("profile.updateError"))}catch(e){f.oR.error(h("common.error"))}finally{k(!1)}};return t||!e?null:(0,s.jsx)("div",{className:"min-h-[calc(100vh-72px)] md:min-h-screen p-4 md:p-12 bg-muted/30 flex md:items-center justify-center font-sans",children:(0,s.jsxs)(l.Zp,{className:"w-full max-w-md border-none shadow-none md:shadow-lg bg-background",children:[(0,s.jsx)(l.aR,{className:"hidden md:flex flex-col gap-1 px-6 pt-8 pb-4",children:(0,s.jsx)(l.ZB,{className:"text-2xl font-bold tracking-tight",children:h("profile.title")})}),(0,s.jsxs)(l.Wu,{className:"px-6 py-8 md:pb-8",children:[v&&(0,s.jsxs)("div",{className:"bg-yellow-50 text-yellow-800 p-3 rounded-md mb-6 text-sm font-medium border border-yellow-100 flex items-center gap-2",children:[(0,s.jsx)(p,{className:"h-4 w-4"}),h("profile.defaultPasswordWarning")]}),(0,s.jsxs)("form",{onSubmit:C,className:"flex flex-col gap-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{htmlFor:"name",children:h("profile.name")}),(0,s.jsx)(u.p,{id:"name",placeholder:h("profile.name"),value:y,onChange:e=>x(e.target.value),required:!0,className:"h-11"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{htmlFor:"newPassword",children:h("profile.newPassword")}),(0,s.jsx)(u.p,{id:"newPassword",placeholder:h("profile.newPassword"),type:"password",value:S,onChange:e=>b(e.target.value),className:"h-11"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:h("profile.leaveBlank")})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m.J,{htmlFor:"confirmPassword",children:h("profile.confirmPassword")}),(0,s.jsx)(u.p,{id:"confirmPassword",placeholder:h("profile.confirmPassword"),type:"password",value:N,onChange:e=>P(e.target.value),className:"h-11"})]})]}),(0,s.jsx)(c.$,{type:"submit",disabled:j,className:"w-full h-11 text-lg",children:j?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.A,{className:"mr-2 h-4 w-4 animate-spin"}),h("profile.saving")]}):h("profile.save")})]})]})]})})}},3312:(e,t,r)=>{"use strict";r.d(t,{$:()=>c,r:()=>d});var s=r(5155),a=r(2115),o=r(2317),n=r(1027),i=r(1567);let d=(0,n.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:r,variant:a,size:n,asChild:c=!1,...l}=e,u=c?o.DX:"button";return(0,s.jsx)(u,{className:(0,i.cn)(d({variant:a,size:n,className:r})),ref:t,...l})});c.displayName="Button"},9749:(e,t,r)=>{"use strict";r.d(t,{BT:()=>c,Wu:()=>l,ZB:()=>d,Zp:()=>n,aR:()=>i,wL:()=>u});var s=r(5155),a=r(2115),o=r(1567);let n=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});n.displayName="Card";let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",r),...a})});i.displayName="CardHeader";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h3",{ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});d.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("p",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r),...a})});c.displayName="CardDescription";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",r),...a})});l.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",r),...a})});u.displayName="CardFooter"},3900:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});var s=r(5155),a=r(2115),o=r(1567);let n=a.forwardRef((e,t)=>{let{className:r,type:a,...n}=e;return(0,s.jsx)("input",{type:a,className:(0,o.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...n})});n.displayName="Input"},8986:(e,t,r)=>{"use strict";r.d(t,{J:()=>c});var s=r(5155),a=r(2115),o=r(6195),n=r(1027),i=r(1567);let d=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(o.b,{ref:t,className:(0,i.cn)(d(),r),...a})});c.displayName=o.b.displayName},8435:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,AuthProvider:()=>n});var s=r(5155),a=r(2115);let o=(0,a.createContext)(void 0),n=e=>{let{children:t}=e,[r,n]=(0,a.useState)(null),[i,d]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=localStorage.getItem("ehr_user");if(e)try{n(JSON.parse(e))}catch(e){localStorage.removeItem("ehr_user")}d(!1)},[]),(0,s.jsx)(o.Provider,{value:{user:r,login:e=>{n(e),localStorage.setItem("ehr_user",JSON.stringify(e))},logout:()=>{n(null),localStorage.removeItem("ehr_user")},isLoading:i},children:t})},i=()=>{let e=(0,a.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},183:(e,t,r)=>{"use strict";r.d(t,{I:()=>i,o:()=>d});var s=r(5155),a=r(2115);let o={en:{common:{appName:"eHRSystem",signOut:"Sign Out",loading:"Loading...",error:"Error",success:"Success",notice:"Notice",systemInfo:"System Info",cancel:"Cancel"},login:{welcomeBack:"Welcome Back",signInToAccount:"Sign in to your eHR account",username:"Username",password:"Password",signIn:"Sign In",signingIn:"Signing in...",invalidCredentials:"Invalid credentials",connectionError:"Failed to connect to the server. Please check your connection and GAS URL.",needHelp:"Need help?",contactSupport:"Contact Support",managementSystem:"Management System",enterUsername:"Enter your username",enterPassword:"Enter your password"},dashboard:{welcome:"Welcome, {name}",role:"Role: {role}",attendanceAction:"Attendance Action",capturedWithGps:"Captured with GPS location",clockIn:"CLOCK IN",clockOut:"CLOCK OUT",capturingLocation:"Capturing location...",recordingClockIn:"Recording Clock In...",recordingClockOut:"Recording Clock Out...",clockedInSuccess:"Clocked in successfully!",clockedOutSuccess:"Clocked out successfully!",failedToRecord:"Failed to record attendance",serverError:"Server connection error. Check GAS URL.",locationError:"Location error: {error}. Please enable GPS.",geoNotSupported:"Geolocation is not supported by your browser",deviceDetected:"Device Detected",gpsStatus:"GPS Status",active:"Active",awaitingPermission:"Awaiting Permission",noticeContent:"Please ensure you are at the work location before clocking in. Your GPS coordinates are recorded for verification.",allRightsReserved:"All rights reserved."},profile:{title:"Edit Profile",name:"Name",newPassword:"New Password",confirmPassword:"Confirm New Password",save:"Save Changes",saving:"Saving...",success:"Profile updated successfully",passwordMismatch:"Passwords do not match",updateError:"Failed to update profile",defaultPasswordWarning:"Please change your default password to continue.",leaveBlank:"Leave blank to keep current password"},admin:{title:"User Management",addUser:"Add User",editUser:"Edit User",deleteUser:"Delete User",resetPassword:"Reset Password",username:"Username",name:"Name",role:"Role",status:"Status",createdAt:"Created At",actions:"Actions",adminRole:"ADMIN",memberRole:"MEMBER",activeStatus:"Active",deletedStatus:"Deleted",confirmDelete:"Are you sure you want to delete this user? This is a soft delete.",confirmReset:'Are you sure you want to reset this user\'s password to "000000"?',addSuccess:"User added successfully",updateSuccess:"User updated successfully",deleteSuccess:"User deleted successfully",resetSuccess:"Password reset successfully",userExists:"Username already exists"}},"zh-tw":{common:{appName:"人事管理系統",signOut:"登出",loading:"載入中...",error:"錯誤",success:"成功",notice:"注意事項",systemInfo:"系統資訊",cancel:"取消"},login:{welcomeBack:"歡迎回來",signInToAccount:"請登入您的人事系統帳號",username:"使用者名稱",password:"密碼",signIn:"登入",signingIn:"登入中...",invalidCredentials:"帳號或密碼錯誤",connectionError:"連線伺服器失敗。請檢查您的網路連線與 GAS 網址。",needHelp:"需要幫助？",contactSupport:"聯繫支援",managementSystem:"管理系統",enterUsername:"請輸入使用者名稱",enterPassword:"請輸入密碼"},dashboard:{welcome:"歡迎，{name}",role:"角色：{role}",attendanceAction:"出勤操作",capturedWithGps:"將記錄 GPS 座標",clockIn:"上班打卡",clockOut:"下班打卡",capturingLocation:"正在取得位置...",recordingClockIn:"正在記錄上班時間...",recordingClockOut:"正在記錄下班時間...",clockedInSuccess:"上班打卡成功！",clockedOutSuccess:"下班打卡成功！",failedToRecord:"記錄出勤失敗",serverError:"伺服器連線錯誤。請檢查 GAS 網址。",locationError:"位置錯誤：{error}。請開啟 GPS。",geoNotSupported:"您的瀏覽器不支援地理位置功能",deviceDetected:"偵測裝置",gpsStatus:"GPS 狀態",active:"已啟用",awaitingPermission:"等待權限",noticeContent:"打卡前請確保您已到達工作地點。系統將會記錄您的 GPS 座標以便查核。",allRightsReserved:"版權所有。"},profile:{title:"編輯個人資料",name:"姓名",newPassword:"新密碼",confirmPassword:"確認新密碼",save:"儲存變更",saving:"儲存中...",success:"個人資料更新成功",passwordMismatch:"密碼不相符",updateError:"更新個人資料失敗",defaultPasswordWarning:"請更改預設密碼以繼續使用。",leaveBlank:"若不修改密碼請留空"},admin:{title:"使用者管理",addUser:"新增使用者",editUser:"編輯使用者",deleteUser:"刪除使用者",resetPassword:"重設密碼",username:"使用者名稱",name:"姓名",role:"角色",status:"狀態",createdAt:"建立時間",actions:"操作",adminRole:"管理員",memberRole:"一般成員",activeStatus:"使用中",deletedStatus:"已刪除",confirmDelete:"您確定要刪除此使用者嗎？這將會是軟刪除。",confirmReset:'您確定要將此使用者的密碼重設為 "000000" 嗎？',addSuccess:"使用者新增成功",updateSuccess:"使用者更新成功",deleteSuccess:"使用者刪除成功",resetSuccess:"密碼重設成功",userExists:"使用者名稱已存在"}}},n=(0,a.createContext)(void 0),i=e=>{let{children:t}=e,[r,i]=(0,a.useState)("en");return(0,a.useEffect)(()=>{let e=localStorage.getItem("language");e&&("en"===e||"zh-tw"===e)?i(e):navigator.language.toLowerCase().startsWith("zh")&&i("zh-tw")},[]),(0,s.jsx)(n.Provider,{value:{language:r,setLanguage:e=>{i(e),localStorage.setItem("language",e)},t:(e,t)=>{let s=e.split("."),a=o[r];for(let t of s){if(void 0===a[t])return e;a=a[t]}let n=a;return"string"==typeof n&&t&&Object.entries(t).forEach(e=>{let[t,r]=e;n=n.replace("{".concat(t,"}"),r)}),n}},children:t})},d=()=>{let e=(0,a.useContext)(n);if(void 0===e)throw Error("useLanguage must be used within a LanguageProvider");return e}},1567:(e,t,r)=>{"use strict";r.d(t,{cn:()=>o});var s=r(3463),a=r(9795);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}},7492:(e,t,r)=>{"use strict";async function s(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>e.toString(16).padStart(2,"0")).join("")}r.d(t,{K:()=>o});let a="https://script.google.com/macros/s/AKfycbykkMfiBgWSCNU1CyMHq_Ist9TdDja9-sPIanCJ893o4gXloFwGxFgbD3FNKUf0AN6v/exec",o={async login(e,t){let r=await s(t);return(await fetch(a,{method:"POST",mode:"cors",body:JSON.stringify({action:"login",username:e,password:r})})).json()},async updateProfile(e,t,r){let o={action:"updateUser",userId:e,name:t};return r&&(o.password=await s(r)),(await fetch(a,{method:"POST",mode:"cors",body:JSON.stringify(o)})).json()},async getUsers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return(await fetch(a,{method:"POST",mode:"cors",body:JSON.stringify({action:"getUsers",page:e,pageSize:t})})).json()},addUser:async(e,t,r)=>(await fetch(a,{method:"POST",mode:"cors",body:JSON.stringify({action:"addUser",username:e,name:t,role:r})})).json(),updateUserAdmin:async(e,t,r)=>(await fetch(a,{method:"POST",mode:"cors",body:JSON.stringify({action:"updateUser",userId:e,name:t,role:r})})).json(),deleteUser:async e=>(await fetch(a,{method:"POST",mode:"cors",body:JSON.stringify({action:"deleteUser",userId:e})})).json(),resetPassword:async e=>(await fetch(a,{method:"POST",mode:"cors",body:JSON.stringify({action:"resetPassword",userId:e})})).json(),recordAttendance:async e=>(await fetch(a,{method:"POST",mode:"cors",body:JSON.stringify({action:"attendance",...e})})).json()}},6195:(e,t,r)=>{"use strict";r.d(t,{b:()=>i});var s=r(2115),a=r(3360),o=r(5155),n=s.forwardRef((e,t)=>(0,o.jsx)(a.sG.label,{...e,ref:t,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null===(r=e.onMouseDown)||void 0===r||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));n.displayName="Label";var i=n},3360:(e,t,r)=>{"use strict";r.d(t,{sG:()=>n});var s=r(2115);r(7650);var a=r(2317),o=r(5155),n=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=(0,a.TL)(`Primitive.${t}`),n=s.forwardRef((e,s)=>{let{asChild:a,...n}=e,i=a?r:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,o.jsx)(i,{...n,ref:s})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{})}},e=>{var t=t=>e(e.s=t);e.O(0,[882,814,441,517,358],()=>t(943)),_N_E=e.O()}]);