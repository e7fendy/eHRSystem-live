(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1263:(e,t,s)=>{Promise.resolve().then(s.bind(s,9809))},9809:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var a=s(5155),r=s(2115),o=s(6046),n=s(8435),d=s(183),l=s(2649),c=s(6240);function i(){let{t:e,language:t}=(0,d.o)(),{user:s,logout:i,isLoading:m}=(0,n.A)(),x=(0,o.useRouter)(),[u,g]=(0,r.useState)("idle"),[h,p]=(0,r.useState)(""),[b,f]=(0,r.useState)(null);(0,r.useEffect)(()=>{m||s||x.push("/login")},[s,m,x]);let v=async t=>{if(g("loading"),p(e("dashboard.capturingLocation")),!navigator.geolocation){g("error"),p(e("dashboard.geoNotSupported"));return}navigator.geolocation.getCurrentPosition(async a=>{let{latitude:r,longitude:o}=a.coords;f({lat:r,lng:o}),p(e("IN"===t?"dashboard.recordingClockIn":"dashboard.recordingClockOut"));try{let a=await l.K.recordAttendance({username:s.username,type:t,latitude:r,longitude:o,userAgent:navigator.userAgent,deviceType:window.innerWidth<768?"mobile":"desktop"});a.success?(g("success"),p(e("IN"===t?"dashboard.clockedInSuccess":"dashboard.clockedOutSuccess")),setTimeout(()=>g("idle"),3e3)):(g("error"),p(a.message||e("dashboard.failedToRecord")))}catch(t){g("error"),p(e("dashboard.serverError"))}},t=>{g("error"),p(e("dashboard.locationError",{error:t.message}))})};return m||!s?null:(0,a.jsxs)("div",{className:"min-h-screen max-w-4xl mx-auto p-4 md:p-8 bg-[#f8fafe] font-sans",children:[(0,a.jsxs)("header",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-10 bg-white p-8 md:p-8 rounded-[32px] md:rounded-[40px] shadow-[0_20px_60px_-15px_rgba(0,0,0,0.08)] border-none",children:[(0,a.jsxs)("div",{className:"text-center md:text-left",children:[(0,a.jsx)("h1",{className:"text-3xl md:text-2xl font-bold text-slate-900 tracking-tight",children:e("dashboard.welcome",{name:s.name})}),(0,a.jsx)("p",{className:"text-slate-400 text-lg md:text-sm font-medium mt-1",children:e("dashboard.role",{role:s.role})})]}),(0,a.jsx)("button",{onClick:i,className:"text-lg md:text-sm font-bold text-slate-500 hover:text-red-600 transition border border-slate-100 px-8 py-4 md:px-6 md:py-2 rounded-[20px] md:rounded-xl hover:border-red-100 hover:bg-red-50 w-full md:w-auto",children:e("common.signOut")})]}),(0,a.jsxs)("main",{className:"grid grid-cols-1 md:grid-cols-2 gap-10 md:gap-8",children:[(0,a.jsxs)("section",{className:"bg-white p-10 md:p-10 rounded-[32px] md:rounded-[40px] shadow-[0_20px_60px_-15px_rgba(0,0,0,0.08)] border-none flex flex-col items-center justify-center space-y-10",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-3xl md:text-2xl font-bold text-slate-900 mb-2",children:e("dashboard.attendanceAction")}),(0,a.jsx)("p",{className:"text-slate-400 text-lg md:text-base font-medium",children:e("dashboard.capturedWithGps")})]}),(0,a.jsxs)("div",{className:"flex flex-col w-full gap-6",children:[(0,a.jsxs)("button",{onClick:()=>v("IN"),disabled:"loading"===u,className:"group relative flex items-center justify-center gap-4 bg-[#5356FF] hover:bg-[#4346FF] text-white font-bold py-10 md:py-8 rounded-[32px] transition-all duration-300 transform active:scale-[0.98] disabled:opacity-50 shadow-xl shadow-indigo-100",children:[(0,a.jsx)("span",{className:"text-4xl md:text-3xl",children:"\uD83D\uDD52"}),(0,a.jsx)("span",{className:"text-2xl md:text-xl font-bold tracking-tight",children:e("dashboard.clockIn")})]}),(0,a.jsxs)("button",{onClick:()=>v("OUT"),disabled:"loading"===u,className:"group relative flex items-center justify-center gap-4 bg-[#e11d48] hover:bg-[#be123c] text-white font-bold py-10 md:py-8 rounded-[32px] transition-all duration-300 transform active:scale-[0.98] disabled:opacity-50 shadow-xl shadow-rose-100",children:[(0,a.jsx)("span",{className:"text-4xl md:text-3xl",children:"⏳"}),(0,a.jsx)("span",{className:"text-2xl md:text-xl font-bold tracking-tight",children:e("dashboard.clockOut")})]})]}),"idle"!==u&&(0,a.jsxs)("div",{className:"w-full p-4 rounded-xl text-center text-sm font-medium transition-all ".concat("loading"===u?"bg-blue-50 text-blue-700":"success"===u?"bg-green-50 text-green-700 border border-green-100":"bg-red-50 text-red-700 border border-red-100"),children:["loading"===u&&(0,a.jsx)("span",{className:"inline-block animate-pulse mr-2",children:"●"}),h]})]}),(0,a.jsxs)("section",{className:"space-y-10 md:space-y-8",children:[(0,a.jsxs)("div",{className:"bg-white p-10 md:p-8 rounded-[32px] md:rounded-[40px] shadow-[0_20px_60px_-15px_rgba(0,0,0,0.08)] border-none",children:[(0,a.jsx)("h3",{className:"text-xl md:text-lg font-bold text-slate-900 mb-8 md:mb-6",children:e("common.systemInfo")}),(0,a.jsxs)("div",{className:"space-y-6 md:space-y-4 text-lg md:text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between py-4 md:py-3 border-b border-slate-50",children:[(0,a.jsx)("span",{className:"text-slate-400 font-medium",children:e("dashboard.deviceDetected")}),(0,a.jsx)("span",{className:"font-bold text-slate-700 capitalize",children:window.innerWidth<768?"zh-tw"===t?"行動裝置":"Mobile":"zh-tw"===t?"電腦":"Desktop"})]}),(0,a.jsxs)("div",{className:"flex justify-between py-4 md:py-3 border-b border-slate-50",children:[(0,a.jsx)("span",{className:"text-slate-400 font-medium",children:e("dashboard.gpsStatus")}),(0,a.jsx)("span",{className:"font-bold ".concat(b?"text-green-500":"text-orange-400"),children:b?e("dashboard.active"):e("dashboard.awaitingPermission")})]}),b&&(0,a.jsxs)("div",{className:"text-xs text-slate-300 mt-4 font-mono",children:["LAT: ",b.lat.toFixed(4),", LNG: ",b.lng.toFixed(4)]})]})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-[#5356FF] to-[#4346FF] p-10 md:p-8 rounded-[32px] md:rounded-[40px] shadow-xl shadow-indigo-100 text-white",children:[(0,a.jsx)("h3",{className:"text-xl md:text-lg font-bold mb-4",children:e("common.notice")}),(0,a.jsx)("p",{className:"text-lg md:text-sm font-medium opacity-90 leading-relaxed",children:e("dashboard.noticeContent")})]})]})]}),(0,a.jsxs)("footer",{className:"mt-16 pb-12 text-center text-slate-400 text-base md:text-sm",children:[(0,a.jsxs)("div",{className:"font-medium",children:["\xa9 ",new Date().getFullYear()," ",e("common.appName"),". ",e("dashboard.allRightsReserved")]}),(0,a.jsx)("div",{className:"mt-8",children:(0,a.jsx)(c.c,{})})]})]})}},6240:(e,t,s)=>{"use strict";s.d(t,{c:()=>i});var a=s(5155),r=s(183),o=s(7216),n=s(3755),d=s(8233),l=s(8267),c=s(8619);let i=()=>{let{language:e,setLanguage:t}=(0,r.o)(),s=[{key:"en",label:"English",flag:"\uD83C\uDDFA\uD83C\uDDF8"},{key:"zh-tw",label:"繁體中文",flag:"\uD83C\uDDF9\uD83C\uDDFC"}],i=s.find(t=>t.key===e)||s[0];return(0,a.jsx)("div",{className:"flex justify-center mt-2",children:(0,a.jsxs)(o.A,{placement:"top",showArrow:!0,classNames:{content:"bg-white border border-gray-100 shadow-xl min-w-[180px] md:min-w-[140px] p-2"},children:[(0,a.jsx)(n.b,{children:(0,a.jsxs)(d.T,{variant:"flat",size:"md",className:"bg-slate-100/50 hover:bg-slate-100 text-slate-500 font-semibold transition-all h-12 md:h-8 px-6 md:px-4 rounded-full",children:[(0,a.jsx)("span",{className:"mr-2 text-xl md:text-sm",children:i.flag}),(0,a.jsx)("span",{className:"text-base md:text-xs",children:i.label})]})}),(0,a.jsx)(l.y,{"aria-label":"Language Selection",onAction:e=>t(e),selectedKeys:[e],selectionMode:"single",itemClasses:{base:["rounded-lg","transition-opacity","py-3 md:py-2","px-3 md:px-2","data-[hover=true]:text-indigo-600","data-[hover=true]:bg-indigo-50","data-[selectable=true]:focus:bg-indigo-50","data-[pressed=true]:opacity-70"],title:"text-base md:text-sm"},children:s.map(t=>(0,a.jsx)(c.Y,{startContent:(0,a.jsx)("span",{className:"text-xl md:text-base mr-2 md:mr-0",children:t.flag}),className:e===t.key?"text-indigo-600 font-semibold":"text-gray-600",children:t.label},t.key))})]})})}},8435:(e,t,s)=>{"use strict";s.d(t,{A:()=>d,AuthProvider:()=>n});var a=s(5155),r=s(2115);let o=(0,r.createContext)(void 0),n=e=>{let{children:t}=e,[s,n]=(0,r.useState)(null),[d,l]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let e=localStorage.getItem("ehr_user");if(e)try{n(JSON.parse(e))}catch(e){localStorage.removeItem("ehr_user")}l(!1)},[]),(0,a.jsx)(o.Provider,{value:{user:s,login:e=>{n(e),localStorage.setItem("ehr_user",JSON.stringify(e))},logout:()=>{n(null),localStorage.removeItem("ehr_user")},isLoading:d},children:t})},d=()=>{let e=(0,r.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},183:(e,t,s)=>{"use strict";s.d(t,{I:()=>d,o:()=>l});var a=s(5155),r=s(2115);let o={en:{common:{appName:"eHR System",signOut:"Sign Out",loading:"Loading...",error:"Error",success:"Success",notice:"Notice",systemInfo:"System Info"},login:{welcomeBack:"Welcome Back",signInToAccount:"Sign in to your eHR account",username:"Username",password:"Password",signIn:"Sign In",signingIn:"Signing in...",invalidCredentials:"Invalid credentials",connectionError:"Failed to connect to the server. Please check your connection and GAS URL.",needHelp:"Need help?",contactSupport:"Contact Support",managementSystem:"Management System",enterUsername:"Enter your username",enterPassword:"Enter your password"},dashboard:{welcome:"Welcome, {name}",role:"Role: {role}",attendanceAction:"Attendance Action",capturedWithGps:"Captured with GPS location",clockIn:"CLOCK IN",clockOut:"CLOCK OUT",capturingLocation:"Capturing location...",recordingClockIn:"Recording Clock In...",recordingClockOut:"Recording Clock Out...",clockedInSuccess:"Clocked in successfully!",clockedOutSuccess:"Clocked out successfully!",failedToRecord:"Failed to record attendance",serverError:"Server connection error. Check GAS URL.",locationError:"Location error: {error}. Please enable GPS.",geoNotSupported:"Geolocation is not supported by your browser",deviceDetected:"Device Detected",gpsStatus:"GPS Status",active:"Active",awaitingPermission:"Awaiting Permission",noticeContent:"Please ensure you are at the work location before clocking in. Your GPS coordinates are recorded for verification.",allRightsReserved:"All rights reserved."}},"zh-tw":{common:{appName:"人事管理系統",signOut:"登出",loading:"載入中...",error:"錯誤",success:"成功",notice:"注意事項",systemInfo:"系統資訊"},login:{welcomeBack:"歡迎回來",signInToAccount:"請登入您的人事系統帳號",username:"使用者名稱",password:"密碼",signIn:"登入",signingIn:"登入中...",invalidCredentials:"帳號或密碼錯誤",connectionError:"連線伺服器失敗。請檢查您的網路連線與 GAS 網址。",needHelp:"需要幫助？",contactSupport:"聯繫支援",managementSystem:"管理系統",enterUsername:"請輸入使用者名稱",enterPassword:"請輸入密碼"},dashboard:{welcome:"歡迎，{name}",role:"角色：{role}",attendanceAction:"出勤操作",capturedWithGps:"將記錄 GPS 座標",clockIn:"上班打卡",clockOut:"下班打卡",capturingLocation:"正在取得位置...",recordingClockIn:"正在記錄上班時間...",recordingClockOut:"正在記錄下班時間...",clockedInSuccess:"上班打卡成功！",clockedOutSuccess:"下班打卡成功！",failedToRecord:"記錄出勤失敗",serverError:"伺服器連線錯誤。請檢查 GAS 網址。",locationError:"位置錯誤：{error}。請開啟 GPS。",geoNotSupported:"您的瀏覽器不支援地理位置功能",deviceDetected:"偵測裝置",gpsStatus:"GPS 狀態",active:"已啟用",awaitingPermission:"等待權限",noticeContent:"打卡前請確保您已到達工作地點。系統將會記錄您的 GPS 座標以便查核。",allRightsReserved:"版權所有。"}}},n=(0,r.createContext)(void 0),d=e=>{let{children:t}=e,[s,d]=(0,r.useState)("en");return(0,r.useEffect)(()=>{let e=localStorage.getItem("language");e&&("en"===e||"zh-tw"===e)?d(e):navigator.language.toLowerCase().startsWith("zh")&&d("zh-tw")},[]),(0,a.jsx)(n.Provider,{value:{language:s,setLanguage:e=>{d(e),localStorage.setItem("language",e)},t:(e,t)=>{let a=e.split("."),r=o[s];for(let t of a){if(void 0===r[t])return e;r=r[t]}return"string"==typeof r&&t&&Object.entries(t).forEach(e=>{let[t,s]=e;r=r.replace("{".concat(t,"}"),s)}),r}},children:t})},l=()=>{let e=(0,r.useContext)(n);if(void 0===e)throw Error("useLanguage must be used within a LanguageProvider");return e}},2649:(e,t,s)=>{"use strict";s.d(t,{K:()=>r});let a="https://script.google.com/macros/s/AKfycbws0CrGA92VJAlgNwbg6nMQNWnJVVfbA1sOJuC_fQzWrrkaFeeBoDMB5EdkxYfxGkHQ/exec",r={login:async(e,t)=>(await fetch(a,{method:"POST",mode:"cors",body:JSON.stringify({action:"login",username:e,password:t})})).json(),recordAttendance:async e=>(await fetch(a,{method:"POST",mode:"cors",body:JSON.stringify({action:"attendance",...e})})).json()}}},e=>{var t=t=>e(e.s=t);e.O(0,[662,251,805,441,517,358],()=>t(1263)),_N_E=e.O()}]);